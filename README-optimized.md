# Boundless节点优化指南

## 优化概述

本项目针对Boundless区块链ZK验证节点进行了一系列优化，旨在提高节点在竞争激烈环境中的抢单成功率。主要优化包括：

1. **订单获取与锁定流程优化**
   - 移除所有前置状态检查，立即尝试锁定订单
   - 使用更高的gas价格（普通配置的3倍）
   - 增大查询区块范围，发现更多订单机会

2. **并行处理能力提升**
   - 将并发订单处理线程增加到12个
   - 优化订单获取和处理的数据结构，减少内存开销
   - 批量处理订单，提高处理效率

3. **响应速度优化**
   - 减少各种轮询间隔，更快地响应状态变化
   - 立即锁定策略，不进行延迟等待
   - 优化错误处理，防止单个失败影响整体处理

## 使用方法

优化已集成到默认配置中，您只需按照原有方式启动节点即可享受性能提升：

```bash
cargo run --release -- -c broker.toml -r <YOUR_RPC_URL> --private-key <YOUR_PRIVATE_KEY>
```

## 优化配置说明

优化后的配置已集成到默认配置文件`broker.toml`中，包含以下关键优化：

- `parallel_order_concurrency = 12` - 并行订单处理线程数
- `lockin_priority_gas = 200000000` - 锁单优先级gas价格
- `min_deadline = 60` - 最小接受订单截止时间（秒）
- `lock_ahead_secs = 0` - 立即锁定订单，不等待
- `lookback_blocks = 50` - 查询历史区块范围
- `max_concurrent_proofs = 10` - 同时处理的最大证明数量
- `status_poll_ms = 50` - 状态轮询间隔(毫秒)，实现更快响应

## 性能监控

可以通过以下日志关键词监控系统性能：

- `快速锁单: 尝试锁定` - 表示正在尝试锁定订单
- `成功锁定订单` - 表示成功锁定了订单
- `启动高并发订单获取器` - 表示并行处理系统已启动

## 进一步优化建议

1. 实现websocket订阅机制，获取实时订单信息
2. 添加内存池监控，更早获取订单信息
3. 实现批量预签名交易，进一步提高响应速度
4. 动态调整gas价格策略，根据网络拥堵情况自动调整

通过以上优化，节点在竞争环境中的订单获取成功率应显著提高。 